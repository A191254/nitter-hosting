services:
  - name: nitter
    type: web
    runtime: image
    image:
      url: ghcr.io/sekai-soft/nitter-self-contained
    plan: free
    envVars:
      - key: NITTER_ACCOUNTS_FILE
        value: /nitter-data/guest_accounts.json
      - key: DISABLE_REDIS
        value: "1"
      - key: REDIS_HOST
        value: nitter-redis
    healthCheckPath: /
    region: oregon
    disk:
      name: nitter-data
      mountPath: /nitter-data
      sizeGB: 1
    autoDeploy: true
    numInstances: 1
  - name: redis
    type: pserv
    runtime: image
    image: 
      url: redis:6-alpine
    command: redis-server --save 60 1 --loglevel warning
    disk:
      name: nitter-redis
      mountPath: /data
    restart: unless-stopped
    healthcheck:
      test: redis-cli ping
      interval: 5s
      timeout: 5s
      retries: 12
